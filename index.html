<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Final - Google Apps Script</title>
</head>
<body>
    <h1>Teste Final do Google Apps Script</h1>
    
    <div>
        <p><strong>URL:</strong> https://script.google.com/macros/s/AKfycbwGxxQ3023wCbkfXIA2SxUdQic0ix4xXaZgqa1jpKfEVB0UdUOgSCmbs2Jyj2zuo3oGxw/exec</p>
        <button onclick="testGET()">Testar GET</button>
        <button onclick="testPOST()">Testar POST (Simular Formulário)</button>
        <button onclick="testRealData()">Testar Dados Reais</button>
    </div>
    
    <div id="result" style="margin-top: 20px; padding: 15px; border: 1px solid #ccc; background: #f9f9f9;"></div>

    <script>
        const URL = 'https://script.google.com/macros/s/AKfycbwGxxQ3023wCbkfXIA2SxUdQic0ix4xXaZgqa1jpKfEVB0UdUOgSCmbs2Jyj2zuo3oGxw/exec';
        
        function testGET() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Testando GET...';
            
            fetch(URL, {
                method: 'GET'
            })
            .then(response => {
                console.log('GET Response:', response);
                return response.text();
            })
            .then(text => {
                resultDiv.innerHTML = `
                    <h3>✅ GET Funcionando!</h3>
                    <p><strong>Resposta:</strong> ${text}</p>
                    <p style="color: green;">Google Apps Script está acessível!</p>
                `;
            })
            .catch(error => {
                console.error('GET Error:', error);
                resultDiv.innerHTML = `
                    <h3>❌ Erro no GET</h3>
                    <p><strong>Erro:</strong> ${error.message}</p>
                `;
            });
        }
        
        function testPOST() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML += '<br><br>Testando POST...';
            
            const testData = {
                sessionId: 'test_session_' + Date.now(),
                currentQuestion: 10,
                timestamp: new Date().toISOString(),
                answers: {
                    question_1: {
                        question: "Nome",
                        answer: "João Silva"
                    },
                    question_2: {
                        question: "Email",
                        answer: "joao@teste.com"
                    },
                    question_3: {
                        question: "Confirmação Whatsapp",
                        answer: "(11) 99999-9999"
                    },
                    question_4: {
                        question: "Qual é o seu gênero?",
                        answer: "Feminino"
                    },
                    question_5: {
                        question: "Qual é sua faixa etária?",
                        answer: "Entre 18-30 anos"
                    },
                    question_6: {
                        question: "Em quais desses perfis você se enquadra atualmente?",
                        answer: "Em busca de mais saúde e autocuidado"
                    },
                    question_7: {
                        question: "Quais produtos você mais se interessa na Renova Be",
                        answer: "Colágeno Verisol® Frutado"
                    },
                    question_8: {
                        question: "Quais foram os motivos que fizeram você cancelar sua assinatura da Renova Be?",
                        answer: "Valor da assinatura muito alto"
                    },
                    question_9: {
                        question: "Quais sugestões você recomendaria à Renova Be que faria você repensar em retomar sua assinatura?",
                        answer: "Melhorar o atendimento e reduzir preços"
                    },
                    question_10: {
                        question: "Em uma escala de 1 a 5, o quanto você recomendaria a Renova Be para seus familiares e amigos?",
                        answer: "4 - Provavelmente"
                    }
                }
            };
            
            // Criar formulário temporário (mesmo método do formulário real)
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = URL;
            form.target = 'hidden-iframe';
            form.style.display = 'none';
            
            const dataInput = document.createElement('input');
            dataInput.type = 'hidden';
            dataInput.name = 'data';
            dataInput.value = JSON.stringify(testData);
            form.appendChild(dataInput);
            
            document.body.appendChild(form);
            
            const iframe = document.createElement('iframe');
            iframe.name = 'hidden-iframe';
            iframe.style.display = 'none';
            document.body.appendChild(iframe);
            
            form.submit();
            
            setTimeout(() => {
                document.body.removeChild(form);
                document.body.removeChild(iframe);
                resultDiv.innerHTML += `
                    <h3>✅ POST Enviado!</h3>
                    <p><strong>Dados enviados:</strong></p>
                    <pre>${JSON.stringify(testData, null, 2)}</pre>
                    <p style="color: green;">Verifique a planilha para ver se os dados chegaram!</p>
                    <p><strong>Próximo passo:</strong> Abra a planilha e verifique se uma nova linha foi adicionada</p>
                `;
            }, 2000);
        }
        
        function testRealData() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML += '<br><br>Testando dados reais do formulário...';
            
            // Simular dados exatos do formulário
            const realData = {
                sessionId: 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                currentQuestion: 10,
                timestamp: new Date().toISOString(),
                answers: {
                    question_1: {
                        question: "Nome",
                        answer: "Maria Santos"
                    },
                    question_2: {
                        question: "Email", 
                        answer: "maria@exemplo.com"
                    },
                    question_3: {
                        question: "Confirmação Whatsapp",
                        answer: "(11) 88888-8888"
                    },
                    question_4: {
                        question: "Qual é o seu gênero?",
                        answer: "Feminino"
                    },
                    question_5: {
                        question: "Qual é sua faixa etária?",
                        answer: "Entre 30-40 anos"
                    },
                    question_6: {
                        question: "Em quais desses perfis você se enquadra atualmente?",
                        answer: "Executiva/ Empresária/ Líder com rotina cheia de compromissos"
                    },
                    question_7: {
                        question: "Quais produtos você mais se interessa na Renova Be",
                        answer: "Creme Retinol"
                    },
                    question_8: {
                        question: "Quais foram os motivos que fizeram você cancelar sua assinatura da Renova Be?",
                        answer: "Atraso no envio dos produtos"
                    },
                    question_9: {
                        question: "Quais sugestões você recomendaria à Renova Be que faria você repensar em retomar sua assinatura?",
                        answer: "Melhorar a logística e prazos de entrega"
                    },
                    question_10: {
                        question: "Em uma escala de 1 a 5, o quanto você recomendaria a Renova Be para seus familiares e amigos?",
                        answer: "3 - Talvez"
                    }
                }
            };
            
            // Usar o mesmo método do formulário real
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = URL;
            form.target = 'hidden-iframe-real';
            form.style.display = 'none';
            
            const dataInput = document.createElement('input');
            dataInput.type = 'hidden';
            dataInput.name = 'data';
            dataInput.value = JSON.stringify(realData);
            form.appendChild(dataInput);
            
            document.body.appendChild(form);
            
            const iframe = document.createElement('iframe');
            iframe.name = 'hidden-iframe-real';
            iframe.style.display = 'none';
            document.body.appendChild(iframe);
            
            form.submit();
            
            setTimeout(() => {
                document.body.removeChild(form);
                document.body.removeChild(iframe);
                resultDiv.innerHTML += `
                    <h3>✅ Dados Reais Enviados!</h3>
                    <p><strong>Dados enviados:</strong></p>
                    <pre>${JSON.stringify(realData, null, 2)}</pre>
                    <p style="color: green;">Verifique a planilha para ver se os dados chegaram!</p>
                    <p><strong>URL da planilha:</strong> https://docs.google.com/spreadsheets/d/1tP-Epb3c52-liN-gSVfaB9FzzUbnC96HCjfyKNcPdS8/edit</p>
                `;
            }, 2000);
        }
        
        // Teste automático ao carregar
        window.onload = function() {
            testGET();
        };
    </script>
</body>
</html> 
