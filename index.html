<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <title>Pesquisa Renova Be</title>

  <!-- Google Analytics 4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-WG5TKP744Z"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }

    gtag('js', new Date());
    gtag('config', 'G-WG5TKP744Z');

    // Dados do formul√°rio
    let formData = {
      timestamp: '',
      currentQuestion: 0,
      answers: {},
      sessionId: generateSessionId()
    };

    function generateSessionId() {
      return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    }

    // Fun√ß√£o CORRIGIDA para mobile - garante que dados cheguem no Sheets
    function sendToGoogleSheets(data) {
      console.log('üîÑ Enviando dados para Google Sheets:', data);
      
      // Verificar se h√° dados v√°lidos para enviar
      if (!data.answers || Object.keys(data.answers).length === 0) {
        console.log('‚ö†Ô∏è Nenhum dado v√°lido para enviar');
        showNotification('Erro: Nenhum dado para enviar', 'error');
        return;
      }
      
      console.log('‚úÖ Dados v√°lidos encontrados, enviando...');
      
      // M√âTODO PRINCIPAL - Formul√°rio com iframe (funciona em mobile)
      try {
        console.log('üîÑ Criando formul√°rio tempor√°rio...');
        
        // Criar um formul√°rio tempor√°rio
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = 'https://script.google.com/macros/s/AKfycbzLr75Ftl7WXQPF2TZu8g3WN9ij1pcCxsMtwMEFtHXlvW-l0BF-NfC569nP-DvE4JLN/exec';
        form.target = 'hidden-iframe';
        form.style.display = 'none';
        
        // Adicionar dados como campo hidden
        const dataInput = document.createElement('input');
        dataInput.type = 'hidden';
        dataInput.name = 'data';
        dataInput.value = JSON.stringify(data);
        form.appendChild(dataInput);
        
        console.log('üì§ Dados JSON preparados:', dataInput.value);
        
        // Adicionar formul√°rio ao DOM
        document.body.appendChild(form);
        
        // Criar iframe oculto para receber resposta
        const iframe = document.createElement('iframe');
        iframe.name = 'hidden-iframe';
        iframe.style.display = 'none';
        document.body.appendChild(iframe);
        
        console.log('üöÄ Enviando formul√°rio...');
        
        // Enviar formul√°rio
        form.submit();
        
        console.log('‚úÖ Formul√°rio enviado com sucesso');
        
        // Mostrar notifica√ß√£o de sucesso
        showNotification('Dados enviados com sucesso! Verifique a planilha.', 'success');
        
        // Limpar formul√°rio ap√≥s envio (aumentado para mobile)
        setTimeout(() => {
          if (document.body.contains(form)) {
            document.body.removeChild(form);
            console.log('üßπ Formul√°rio removido do DOM');
          }
          if (document.body.contains(iframe)) {
            document.body.removeChild(iframe);
            console.log('üßπ Iframe removido do DOM');
          }
        }, 8000); // Aumentado para 8 segundos para mobile
        
      } catch (error) {
        console.error('‚ùå Erro ao enviar dados:', error);
        
        // FALLBACK 1 - XMLHttpRequest
        console.log('üîÑ Tentando fallback XMLHttpRequest...');
        
        try {
          const xhr = new XMLHttpRequest();
          xhr.open('POST', 'https://script.google.com/macros/s/AKfycbzLr75Ftl7WXQPF2TZu8g3WN9ij1pcCxsMtwMEFtHXlvW-l0BF-NfC569nP-DvE4JLN/exec', true);
          xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
          
          const formData = new FormData();
          formData.append('data', JSON.stringify(data));
          
          xhr.onload = function() {
            console.log('üì• Resposta XMLHttpRequest:', xhr.responseText);
            if (xhr.status === 200) {
              showNotification('Dados enviados com sucesso! (XMLHttpRequest)', 'success');
            } else {
              showNotification('Erro ao enviar dados. Status: ' + xhr.status, 'error');
            }
          };
          
          xhr.onerror = function() {
            console.error('‚ùå Erro XMLHttpRequest');
            showNotification('Erro de conex√£o. Tente novamente.', 'error');
          };
          
          xhr.send(formData);
          
        } catch (fallbackError) {
          console.error('‚ùå Erro no fallback:', fallbackError);
          
          // FALLBACK 2 - Fetch com no-cors
          console.log('üîÑ Tentando fallback fetch...');
          
          fetch('https://script.google.com/macros/s/AKfycbzLr75Ftl7WXQPF2TZu8g3WN9ij1pcCxsMtwMEFtHXlvW-l0BF-NfC569nP-DvE4JLN/exec', {
            method: 'POST',
            mode: 'no-cors',
            headers: {
              'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: 'data=' + encodeURIComponent(JSON.stringify(data))
          })
          .then(() => {
            showNotification('Dados enviados com sucesso! (Fetch)', 'success');
          })
          .catch((fetchError) => {
            console.error('‚ùå Erro no fetch:', fetchError);
            showNotification('Erro ao enviar dados. Tente novamente.', 'error');
          });
        }
      }
    }

    function showNotification(message, type) {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        left: 20px;
        padding: 15px 20px;
        border-radius: 8px;
        color: white;
        font-weight: bold;
        z-index: 1000;
        background: ${type === 'success' ? '#4CAF50' : '#f44336'};
        max-width: 100%;
        word-wrap: break-word;
        text-align: center;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      `;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        if (document.body.contains(notification)) {
          notification.remove();
        }
      }, 10000); // Aumentado para 10 segundos
    }

    // Fun√ß√£o CORRIGIDA para mostrar agradecimento
    function showThankYou() {
      console.log('üéâ Mostrando agradecimento...');
      
      // Esconder o formul√°rio
      const formContainer = document.querySelector('.form-container');
      if (formContainer) {
        formContainer.style.display = 'none';
        console.log('‚úÖ Formul√°rio escondido');
      }
      
      // Mostrar agradecimento
      const thankYou = document.getElementById('thankYou');
      if (thankYou) {
        thankYou.style.display = 'block';
        console.log('‚úÖ Agradecimento mostrado');
      }
      
      // Mudar o t√≠tulo da p√°gina
      const title = document.querySelector('h1');
      if (title) {
        title.textContent = 'Obrigada pela participa√ß√£o! üíñ';
        console.log('‚úÖ T√≠tulo alterado');
      }
      
      console.log('‚úÖ Agradecimento exibido com sucesso');
    }

    window.onload = () => {
      // Evento: formul√°rio aberto
      gtag('event', 'form_aberto', {
        form_name: 'PESQUISA_RENOVA_BE',
        session_id: formData.sessionId
      });

      // Evento: formul√°rio carregado
      gtag('event', 'form_carregado', {
        form_name: 'PESQUISA_RENOVA_BE',
        session_id: formData.sessionId
      });

      console.log('üìä Formul√°rio carregado e rastreamento ativo');
    };
  </script>

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #ffffff;
      color: #222222;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      overflow-x: hidden;
    }

    header {
      width: 100%;
      background-color: #000;
      padding: 15px 0;
      text-align: center;
    }

    header img {
      height: 50px;
      max-width: 100%;
    }

    h1 {
      color: #d61392;
      margin: 15px 0;
      font-size: 22px;
      text-align: center;
      padding: 0 15px;
      line-height: 1.3;
      transition: all 0.5s ease;
    }

    .form-container {
      width: 100%;
      max-width: 600px;
      padding: 15px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin: 10px;
      overflow: hidden;
      transition: all 0.5s ease;
    }

    .welcome-message {
      text-align: center;
      margin-bottom: 25px;
      padding: 20px 15px;
      background: #f9f9f9;
      border-radius: 8px;
      border-left: 4px solid #d61392;
    }

    .welcome-message p {
      margin: 0 0 10px 0;
      line-height: 1.6;
      color: #333;
      font-size: 14px;
    }

    .question {
      display: none;
      animation: fadeIn 0.5s ease-in;
      padding: 0 5px;
    }

    .question.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .question h3 {
      color: #d61392;
      margin-bottom: 20px;
      font-size: 18px;
      line-height: 1.4;
      padding: 0 5px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .option {
      padding: 15px 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      background: #f9f9f9;
      display: flex;
      align-items: center;
      min-height: 60px;
      word-wrap: break-word;
    }

    .option-number {
      background: #d61392;
      color: white;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      margin-right: 12px;
      flex-shrink: 0;
      font-size: 14px;
    }

    .option:hover {
      border-color: #d61392;
      background: #fff5f9;
    }

    .option.selected {
      border-color: #d61392;
      background: #fff5f9;
    }

    .option span {
      font-size: 14px;
      line-height: 1.4;
      flex: 1;
    }

    .text-input {
      width: 100%;
      padding: 15px 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s ease;
      box-sizing: border-box;
      font-family: inherit;
    }

    .text-input:focus {
      outline: none;
      border-color: #d61392;
    }

    .navigation {
      display: flex;
      justify-content: space-between;
      margin-top: 25px;
      padding-top: 20px;
      border-top: 1px solid #e0e0e0;
      gap: 10px;
    }

    .btn {
      padding: 15px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
      min-width: 100px;
      font-weight: 500;
      flex: 1;
      max-width: 150px;
    }

    .btn-prev {
      background: #f0f0f0;
      color: #666;
    }

    .btn-next {
      background: #d61392;
      color: white;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .btn:active {
      transform: translateY(0);
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: #e0e0e0;
      border-radius: 3px;
      margin: 20px 0;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #d61392, #ff69b4);
      transition: width 0.3s ease;
    }

    .thank-you {
      text-align: center;
      padding: 40px 20px;
      display: none;
      animation: fadeIn 0.5s ease-in;
    }

    .thank-you h2 {
      color: #d61392;
      margin-bottom: 20px;
      font-size: 24px;
      line-height: 1.3;
    }

    .thank-you p {
      font-size: 16px;
      line-height: 1.6;
      color: #666;
      margin-bottom: 15px;
    }

    .thank-you strong {
      color: #d61392;
      font-size: 18px;
    }

    /* Responsividade aprimorada */
    @media (max-width: 480px) {
      .form-container {
        margin: 5px;
        padding: 12px;
      }
      
      .question h3 {
        font-size: 16px;
        margin-bottom: 15px;
      }
      
      .option {
        padding: 12px 10px;
        min-height: 50px;
      }

      .option span {
        font-size: 13px;
      }

      .option-number {
        width: 24px;
        height: 24px;
        font-size: 12px;
        margin-right: 10px;
      }

      .btn {
        padding: 12px 15px;
        font-size: 14px;
        min-width: 80px;
      }

      .text-input {
        padding: 12px 10px;
        font-size: 16px;
      }

      .welcome-message {
        padding: 15px 12px;
      }

      .welcome-message p {
        font-size: 13px;
      }

      .thank-you {
        padding: 30px 15px;
      }

      .thank-you h2 {
        font-size: 20px;
      }

      .thank-you p {
        font-size: 14px;
      }

      h1 {
        font-size: 20px;
        margin: 10px 0;
      }

      header {
        padding: 10px 0;
      }

      header img {
        height: 40px;
      }
    }

    @media (max-width: 360px) {
      .form-container {
        margin: 2px;
        padding: 10px;
      }
      
      .option {
        padding: 10px 8px;
        min-height: 45px;
      }

      .option span {
        font-size: 12px;
      }

      .btn {
        padding: 10px 12px;
        font-size: 13px;
      }
    }
  </style>
</head>

<body>
  <header>
    <img src="https://i.ibb.co/chSdvTzv/Captura-de-tela-2025-08-07-092118.png" alt="Renova Be" />
  </header>

  <h1>Pesquisa de Satisfa√ß√£o Assinaturas Renova Be</h1>

  <div class="form-container">
    <div class="welcome-message">
      <p>Bem-vindo(a) ao formul√°rio da Renova Be Assinaturas. S√£o 10 perguntas r√°pidas para entendermos melhor suas necessidades e melhorar nossos servi√ßos.</p>
      <p>Sua opini√£o faz a diferen√ßa. Vamos come√ßar?</p>
    </div>

    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>

    <!-- Pergunta 1 -->
    <div class="question active" data-question="1">
      <h3>1. Nome *</h3>
      <input type="text" class="text-input" placeholder="Digite seu nome completo">
    </div>

    <!-- Pergunta 2 -->
    <div class="question" data-question="2">
      <h3>2. Email *</h3>
      <input type="email" class="text-input" placeholder="seu@email.com">
    </div>

    <!-- Pergunta 3 -->
    <div class="question" data-question="3">
      <h3>3. Confirma√ß√£o Whatsapp *</h3>
      <input type="tel" class="text-input" placeholder="(00) 00000-0000">
    </div>

    <!-- Pergunta 4 -->
    <div class="question" data-question="4">
      <h3>4. Qual √© o seu g√™nero? *</h3>
      <div class="options">
        <div class="option" data-value="Feminino">
          <div class="option-number">1</div>
          <span>Feminino</span>
        </div>
        <div class="option" data-value="Masculino">
          <div class="option-number">2</div>
          <span>Masculino</span>
        </div>
        <div class="option" data-value="Prefiro n√£o dizer">
          <div class="option-number">3</div>
          <span>Prefiro n√£o dizer</span>
        </div>
        <div class="option" data-value="Outros">
          <div class="option-number">4</div>
          <span>Outros</span>
        </div>
      </div>
    </div>

    <!-- Pergunta 5 -->
    <div class="question" data-question="5">
      <h3>5. Qual √© sua faixa et√°ria? *</h3>
      <div class="options">
        <div class="option" data-value="Entre 18-30 anos">
          <div class="option-number">1</div>
          <span>Entre 18-30 anos</span>
        </div>
        <div class="option" data-value="Entre 30-40 anos">
          <div class="option-number">2</div>
          <span>Entre 30-40 anos</span>
        </div>
        <div class="option" data-value="Entre 40-50 anos">
          <div class="option-number">3</div>
          <span>Entre 40-50 anos</span>
        </div>
        <div class="option" data-value="Acima de 50 anos">
          <div class="option-number">4</div>
          <span>Acima de 50 anos</span>
        </div>
      </div>
    </div>

    <!-- Pergunta 6 -->
    <div class="question" data-question="6">
      <h3>6. Em quais desses perfis voc√™ se enquadra atualmente? *</h3>
      <div class="options">
        <div class="option" data-value="C√¥njuge acompanhado a rotina do(a) parceiro(a)">
          <div class="option-number">1</div>
          <span>C√¥njuge acompanhado a rotina do(a) parceiro(a)</span>
        </div>
        <div class="option" data-value="Buscando redu√ß√£o das marcas de envelhecimento">
          <div class="option-number">2</div>
          <span>Buscando redu√ß√£o das marcas de envelhecimento</span>
        </div>
        <div class="option" data-value="Em busca de mais sa√∫de e autocuidado">
          <div class="option-number">3</div>
          <span>Em busca de mais sa√∫de e autocuidado</span>
        </div>
        <div class="option" data-value="Executiva/ Empres√°ria/ L√≠der com rotina cheia de compromissos">
          <div class="option-number">4</div>
          <span>Executiva/ Empres√°ria/ L√≠der com rotina cheia de compromissos</span>
        </div>
        <div class="option" data-value="Gestante que pratica exerc√≠cios regularmente">
          <div class="option-number">5</div>
          <span>Gestante que pratica exerc√≠cios regularmente</span>
        </div>
        <div class="option" data-value="Praticante de exerc√≠cios f√≠sicos diariamente">
          <div class="option-number">6</div>
          <span>Praticante de exerc√≠cios f√≠sicos diariamente</span>
        </div>
        <div class="option" data-value="Trabalhador(a) preocupado(a) com o autocuidado">
          <div class="option-number">7</div>
          <span>Trabalhador(a) preocupado(a) com o autocuidado</span>
        </div>
      </div>
    </div>

    <!-- Pergunta 7 -->
    <div class="question" data-question="7">
      <h3>7. Quais produtos voc√™ mais se interessa na Renova Be *</h3>
      <div class="options">
        <div class="option" data-value="Col√°geno Verisol¬Æ Frutado">
          <div class="option-number">1</div>
          <span>Col√°geno Verisol¬Æ Frutado</span>
        </div>
        <div class="option" data-value="Col√°geno Verisol¬Æ Chocolate">
          <div class="option-number">2</div>
          <span>Col√°geno Verisol¬Æ Chocolate</span>
        </div>
        <div class="option" data-value="Col√°geno Lac & Gest">
          <div class="option-number">3</div>
          <span>Col√°geno Lac & Gest</span>
        </div>
        <div class="option" data-value="Col√°geno Tipo 2">
          <div class="option-number">4</div>
          <span>Col√°geno Tipo 2</span>
        </div>
        <div class="option" data-value="Creatina + Morning Shot">
          <div class="option-number">5</div>
          <span>Creatina + Morning Shot</span>
        </div>
        <div class="option" data-value="Creme Al√≠vio Flex">
          <div class="option-number">6</div>
          <span>Creme Al√≠vio Flex</span>
        </div>
        <div class="option" data-value="Creme Resveratrol">
          <div class="option-number">7</div>
          <span>Creme Resveratrol</span>
        </div>
        <div class="option" data-value="Creme Retinol">
          <div class="option-number">8</div>
          <span>Creme Retinol</span>
        </div>
        <div class="option" data-value="Espuma de Limpeza Facial">
          <div class="option-number">9</div>
          <span>Espuma de Limpeza Facial</span>
        </div>
        <div class="option" data-value="Hidratante Labial">
          <div class="option-number">10</div>
          <span>Hidratante Labial</span>
        </div>
        <div class="option" data-value="M√°scara de Argila">
          <div class="option-number">11</div>
          <span>M√°scara de Argila</span>
        </div>
        <div class="option" data-value="Melatonina">
          <div class="option-number">12</div>
          <span>Melatonina</span>
        </div>
        <div class="option" data-value="Multivitam√≠nico">
          <div class="option-number">13</div>
          <span>Multivitam√≠nico</span>
        </div>
        <div class="option" data-value="√îmega 3">
          <div class="option-number">14</div>
          <span>√îmega 3</span>
        </div>
        <div class="option" data-value="S√©rum Facial">
          <div class="option-number">15</div>
          <span>S√©rum Facial</span>
        </div>
        <div class="option" data-value="Whey Protein">
          <div class="option-number">16</div>
          <span>Whey Protein</span>
        </div>
      </div>
    </div>

    <!-- Pergunta 8 -->
    <div class="question" data-question="8">
      <h3>8. Quais foram os motivos que fizeram voc√™ cancelar sua assinatura da Renova Be? *</h3>
      <div class="options">
        <div class="option" data-value="Atraso no envio dos produtos">
          <div class="option-number">1</div>
          <span>Atraso no envio dos produtos</span>
        </div>
        <div class="option" data-value="Avarias nas embalagens">
          <div class="option-number">2</div>
          <span>Avarias nas embalagens</span>
        </div>
        <div class="option" data-value="Falta de atendimento do suporte">
          <div class="option-number">3</div>
          <span>Falta de atendimento do suporte</span>
        </div>
        <div class="option" data-value="Falta de outras op√ß√µes de pagamento">
          <div class="option-number">4</div>
          <span>Falta de outras op√ß√µes de pagamento</span>
        </div>
        <div class="option" data-value="Falta de possibilidade de escolher sabores">
          <div class="option-number">5</div>
          <span>Falta de possibilidade de escolher sabores</span>
        </div>
        <div class="option" data-value="Informa√ß√µes incorretas/ incompletas">
          <div class="option-number">6</div>
          <span>Informa√ß√µes incorretas/ incompletas</span>
        </div>
        <div class="option" data-value="Possuia mais de uma assinatura">
          <div class="option-number">7</div>
          <span>Possuia mais de uma assinatura</span>
        </div>
        <div class="option" data-value="Quantidade insuficiente para o m√™s">
          <div class="option-number">8</div>
          <span>Quantidade insuficiente para o m√™s</span>
        </div>
        <div class="option" data-value="Uso do limite do cart√£o de cr√©dito">
          <div class="option-number">9</div>
          <span>Uso do limite do cart√£o de cr√©dito</span>
        </div>
        <div class="option" data-value="Valor da assinatura muito alto">
          <div class="option-number">10</div>
          <span>Valor da assinatura muito alto</span>
        </div>
      </div>
    </div>

    <!-- Pergunta 9 -->
    <div class="question" data-question="9">
      <h3>9. Quais sugest√µes voc√™ recomendaria √† Renova Be que faria voc√™ repensar em retomar sua assinatura? *</h3>
      <textarea class="text-input" rows="4" placeholder="Digite suas sugest√µes aqui..."></textarea>
    </div>

    <!-- Pergunta 10 -->
    <div class="question" data-question="10">
      <h3>10. Em uma escala de 1 a 5, o quanto voc√™ recomendaria a Renova Be para seus familiares e amigos? *</h3>
      <div class="options">
        <div class="option" data-value="1 - N√£o recomendaria">
          <div class="option-number">1</div>
          <span>1 - N√£o recomendaria</span>
        </div>
        <div class="option" data-value="2 - Pouco prov√°vel">
          <div class="option-number">2</div>
          <span>2 - Pouco prov√°vel</span>
        </div>
        <div class="option" data-value="3 - Talvez">
          <div class="option-number">3</div>
          <span>3 - Talvez</span>
        </div>
        <div class="option" data-value="4 - Provavelmente">
          <div class="option-number">4</div>
          <span>4 - Provavelmente</span>
        </div>
        <div class="option" data-value="5 - Definitivamente">
          <div class="option-number">5</div>
          <span>5 - Definitivamente</span>
        </div>
      </div>
    </div>

    <!-- Agradecimento -->
    <div class="thank-you" id="thankYou">
      <h2>Obrigada pela participa√ß√£o! üíñ</h2>
      <p>Sua opini√£o √© muito importante para n√≥s. Entraremos em contato em breve!</p>
      <p><strong>Atenciosamente,<br>Equipe Renova Be</strong></p>
    </div>

    <div class="navigation">
      <button class="btn btn-prev" id="prevBtn" onclick="previousQuestion()">Anterior</button>
      <button class="btn btn-next" id="nextBtn" onclick="nextQuestion()">Pr√≥ximo</button>
    </div>
  </div>

  <script>
    let currentQuestion = 1;
    const totalQuestions = 10;
    const answers = {};

    // Inicializar rastreamento da primeira pergunta
    window.onload = function() {
      // Apenas rastrear no Google Analytics (sem enviar dados)
      gtag('event', 'form_pergunta_iniciada', {
        form_name: 'PESQUISA_RENOVA_BE',
        pergunta_numero: 1,
        pergunta_texto: "Nome",
        session_id: formData.sessionId
      });
      updateProgress();
    };

    function updateProgress() {
      const progress = (currentQuestion / totalQuestions) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
    }

    function showQuestion(questionNumber) {
      // Esconder todas as perguntas
      document.querySelectorAll('.question').forEach(q => {
        q.classList.remove('active');
      });

      // Mostrar pergunta atual
      const question = document.querySelector(`[data-question="${questionNumber}"]`);
      if (question) {
        question.classList.add('active');
      }

      // Atualizar bot√µes
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');

      prevBtn.style.display = questionNumber === 1 ? 'none' : 'block';
      nextBtn.textContent = questionNumber === totalQuestions ? 'Enviar' : 'Pr√≥ximo';

      updateProgress();
    }

    function getQuestionText(questionNumber) {
      const questionMap = {
        1: "Nome",
        2: "Email",
        3: "Confirma√ß√£o Whatsapp",
        4: "Qual √© o seu g√™nero?",
        5: "Qual √© sua faixa et√°ria?",
        6: "Em quais desses perfis voc√™ se enquadra atualmente?",
        7: "Quais produtos voc√™ mais se interessa na Renova Be",
        8: "Quais foram os motivos que fizeram voc√™ cancelar sua assinatura da Renova Be?",
        9: "Quais sugest√µes voc√™ recomendaria √† Renova Be que faria voc√™ repensar em retomar sua assinatura?",
        10: "Em uma escala de 1 a 5, o quanto voc√™ recomendaria a Renova Be para seus familiares e amigos?"
      };
      return questionMap[questionNumber] || "";
    }

    function getCurrentAnswer() {
      const currentQuestionEl = document.querySelector(`[data-question="${currentQuestion}"]`);
      
      if (currentQuestionEl.querySelector('.text-input')) {
        return currentQuestionEl.querySelector('.text-input').value;
      } else if (currentQuestionEl.querySelector('textarea')) {
        return currentQuestionEl.querySelector('textarea').value;
      } else {
        const selectedOption = currentQuestionEl.querySelector('.option.selected');
        return selectedOption ? selectedOption.dataset.value : null;
      }
    }

    function nextQuestion() {
      const currentAnswer = getCurrentAnswer();
      
      if (currentAnswer) {
        answers[`question_${currentQuestion}`] = {
          question: getQuestionText(currentQuestion),
          answer: currentAnswer
        };

        // Rastrear resposta no Analytics
        gtag('event', 'form_resposta_enviada', {
          form_name: 'PESQUISA_RENOVA_BE',
          pergunta_numero: currentQuestion,
          pergunta_texto: getQuestionText(currentQuestion),
          resposta: currentAnswer,
          session_id: formData.sessionId
        });

        // Atualizar dados do formul√°rio
        formData.answers[`question_${currentQuestion}`] = {
          question: getQuestionText(currentQuestion),
          answer: currentAnswer
        };
      }

      if (currentQuestion < totalQuestions) {
        currentQuestion++;
        showQuestion(currentQuestion);
        
        // Rastrear nova pergunta (sem enviar dados)
        gtag('event', 'form_pergunta_iniciada', {
          form_name: 'PESQUISA_RENOVA_BE',
          pergunta_numero: currentQuestion,
          pergunta_texto: getQuestionText(currentQuestion),
          session_id: formData.sessionId
        });
      } else {
        // Formul√°rio completo - ENVIAR DADOS COMPLETOS
        gtag('event', 'form_completado', {
          form_name: 'PESQUISA_RENOVA_BE',
          session_id: formData.sessionId,
          total_perguntas: totalQuestions
        });

        // Enviar dados finais completos para Google Sheets
        formData.answers = answers;
        formData.currentQuestion = totalQuestions;
        formData.timestamp = new Date().toISOString();
        
        console.log('üì§ Enviando dados completos:', formData);
        sendToGoogleSheets(formData);

        // Mostrar agradecimento AP√ìS enviar dados
        setTimeout(() => {
          showThankYou();
        }, 3000); // Aumentado para 3 segundos para garantir que os dados foram enviados
      }
    }

    function previousQuestion() {
      if (currentQuestion > 1) {
        currentQuestion--;
        showQuestion(currentQuestion);
        
        // Rastrear retorno √† pergunta (sem enviar dados)
        gtag('event', 'form_pergunta_iniciada', {
          form_name: 'PESQUISA_RENOVA_BE',
          pergunta_numero: currentQuestion,
          pergunta_texto: getQuestionText(currentQuestion),
          session_id: formData.sessionId
        });
      }
    }

    // Event listeners para op√ß√µes
    document.addEventListener('click', function(e) {
      if (e.target.classList.contains('option')) {
        // Remover sele√ß√£o anterior
        e.target.parentElement.querySelectorAll('.option').forEach(opt => {
          opt.classList.remove('selected');
        });
        
        // Selecionar nova op√ß√£o
        e.target.classList.add('selected');
      }
    });

    // Event listeners para inputs
    document.addEventListener('input', function(e) {
      if (e.target.classList.contains('text-input')) {
        // Rastrear digita√ß√£o em tempo real
        gtag('event', 'form_digitacao', {
          form_name: 'PESQUISA_RENOVA_BE',
          pergunta_numero: currentQuestion,
          pergunta_texto: getQuestionText(currentQuestion),
          session_id: formData.sessionId
        });
      }
    });

    // Rastrear sa√≠da da p√°gina
    window.addEventListener('beforeunload', function() {
      gtag('event', 'form_abandonado', {
        form_name: 'PESQUISA_RENOVA_BE',
        pergunta_atual: currentQuestion,
        pergunta_texto: getQuestionText(currentQuestion),
        session_id: formData.sessionId
      });
    });
  </script>
</body>
</html> 
